(window.webpackJsonp=window.webpackJsonp||[]).push([["menu","chunk-4b401a06","chunk-5a2193b3"],{2011:function(e,t,n){"use strict";n.r(t);n("7f7f");var r=n("75fc"),i=n("5b64"),o=n("9db4"),a=n("e782"),s=(n("2f62"),{name:"MenuPage",components:{editForm:o.default,relateInterfaceForm:a.default},data:function(){return{formEdit:!1,currentId:0,menuList:[],defaultProps:{label:"name"},menuform:{menuId:"",parentId:0,name:"",url:"",icon:"",perms:"",orderNum:0,type:1},typeOptions:[{value:0,label:"目录"},{value:1,label:"菜单"},{value:2,label:"功能"}],editFormDialogVisible:!1,relateInterfaceDialogVisible:!1,canAdd:this.hasPermissions(["save"],this.$store.state.d2admin.page.currentPath),canUpdate:this.hasPermissions(["update"],this.$store.state.d2admin.page.currentPath),canDelete:this.hasPermissions(["delete"],this.$store.state.d2admin.page.currentPath),isAdd:!1}},methods:{filterType:function(e){for(var t=e,n=0;n<t.length;n++){var r=t[n];2===r.type?t.splice(n--,1):r.children&&0<r.children.length&&this.filterType(r.children)}return t},getMenuList:function(){var n=this;i.d().then(function(e){var t=n.filterType(Object(r.a)(e));n.menuList=t})},getMenuData:function(e){var t=this,n=e.menuId;i.c(n).then(function(e){t.menuform={menuId:e.menuId,parentId:e.parentId,name:e.name,url:e.url,icon:e.icon,perms:e.perms,orderNum:e.orderNum,type:e.type},t.currentId=n})},add:function(){this.menuform={parentId:this.currentId},this.formEdit=!0,this.isAdd=!0},edit:function(){this.formEdit=!0},del:function(){var e=this;this.$confirm("确认删除？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){i.b(e.currentId).then(function(){e.currentId=0,e.getMenuList()})})},cancel:function(){this.formEdit=!1,this.currentId=0,this.menuform={}},submit:function(){var e=this;this.isAdd?i.a(this.menuform).then(function(){e.getMenuList(),e.isAdd=!1}):i.e(this.menuform).then(function(){e.getMenuList()})},reset:function(){this.menuform={id:this.currentId,parentId:this.menuform.parentId,title:"",path:"",icon:"",permission:"",sort:0,type:1,isLock:!1}},batchEdit:function(){this.editFormDialogVisible=!this.editFormDialogVisible},openInterfaceDialog:function(){this.relateInterfaceDialogVisible=!this.relateInterfaceDialogVisible}},created:function(){this.getMenuList()}}),l=n("2877"),c=function(e){e.options.__source="src/views/sys/menu/index.vue"},u=Object(l.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("d2-container",[n("el-button-group",[t.canAdd?n("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini"},on:{click:t.add}},[t._v("添加")]):t._e(),t.canUpdate?n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",disabled:!t.currentId,size:"mini"},on:{click:t.edit}},[t._v("编辑")]):t._e(),t.canDelete?n("el-button",{attrs:{type:"primary",icon:"el-icon-delete",disabled:!t.currentId,size:"mini"},on:{click:t.del}},[t._v("删除")]):t._e(),t.canDelete?n("el-button",{attrs:{type:"primary",icon:"el-icon-circle-close-outline",disabled:!t.currentId,size:"mini"},on:{click:t.cancel}},[t._v("取消")]):t._e()],1),n("el-popover",{attrs:{placement:"top-start",title:"温馨提示",width:"400",trigger:"hover"}},[n("li",[t._v("请不要在`功能`类型节点下建子节点")]),n("li",[t._v("`菜单`类型节点的权限标识请设置为其某个`功能`类型子节点的权限标识")]),n("el-button",{staticStyle:{float:"right"},attrs:{slot:"reference",size:"mini",icon:"el-icon-info"},slot:"reference"},[t._v("操作提示")])],1),n("el-row",[n("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:8}},[n("el-tree",{ref:"tree",staticClass:"filter-tree",attrs:{"node-key":"menuId","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,data:t.menuList,props:t.defaultProps},on:{"node-click":t.getMenuData}})],1),n("el-col",{staticStyle:{"margin-top":"15px"},attrs:{span:16}},[n("el-card",{attrs:{shadow:"always"}},[n("el-form",{ref:"menuform",attrs:{"label-position":"right","label-width":"80px",model:t.menuform}},[n("el-form-item",{attrs:{label:"父级节点",prop:"parentId"}},[n("el-input",{attrs:{disabled:!0,placeholder:"父级节点"},model:{value:t.menuform.parentId,callback:function(e){t.$set(t.menuform,"parentId",e)},expression:"menuform.parentId"}})],1),n("el-form-item",{attrs:{label:"标题",prop:"name",rules:[{required:!0,message:"不能为空"}]}},[n("el-input",{attrs:{disabled:!t.formEdit,placeholder:"请输入标题"},model:{value:t.menuform.name,callback:function(e){t.$set(t.menuform,"name",e)},expression:"menuform.name"}})],1),n("el-form-item",{attrs:{label:"路径",prop:"url",rules:[{required:!0,message:"不能为空"}]}},[n("el-input",{attrs:{disabled:!t.formEdit,placeholder:"请输入路径"},model:{value:t.menuform.url,callback:function(e){t.$set(t.menuform,"url",e)},expression:"menuform.url"}})],1),n("el-form-item",{attrs:{label:"图标",prop:"icon"}},[n("d2-icon-select",{attrs:{"user-input":!0},model:{value:t.menuform.icon,callback:function(e){t.$set(t.menuform,"icon",e)},expression:"menuform.icon"}})],1),n("el-form-item",{attrs:{label:"权限标识",prop:"perms"}},[n("el-input",{attrs:{disabled:!t.formEdit,placeholder:"请输入权限标识"},model:{value:t.menuform.perms,callback:function(e){t.$set(t.menuform,"perms",e)},expression:"menuform.perms"}})],1),n("el-form-item",{attrs:{label:"排序",prop:"orderNum"}},[n("el-input",{attrs:{disabled:!t.formEdit,placeholder:"请输入排序"},model:{value:t.menuform.orderNum,callback:function(e){t.$set(t.menuform,"orderNum",e)},expression:"menuform.orderNum"}})],1),n("el-form-item",{attrs:{label:"类型",prop:"type",rules:[{required:!0,message:"请选择类型"}]}},[n("el-select",{staticClass:"filter-item",attrs:{disabled:!t.formEdit,placeholder:"请选择类型"},model:{value:t.menuform.type,callback:function(e){t.$set(t.menuform,"type",e)},expression:"menuform.type"}},t._l(t.typeOptions,function(e){return n("el-option",{key:e.velue,attrs:{label:e.label,value:e.value}})}),1)],1),t.formEdit?n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")]),n("el-button",{on:{click:t.reset}},[t._v("清空")])],1):t._e()],1)],1)],1)],1),n("edit-form",{on:{submit:t.getMenuList},model:{value:t.editFormDialogVisible,callback:function(e){t.editFormDialogVisible=e},expression:"editFormDialogVisible"}}),n("relate-interface-form",{attrs:{menu:t.menuform},model:{value:t.relateInterfaceDialogVisible,callback:function(e){t.relateInterfaceDialogVisible=e},expression:"relateInterfaceDialogVisible"}})],1)},[],!1,null,null,null);"function"==typeof c&&c(u);t.default=u.exports},"2f21":function(e,t,n){"use strict";var r=n("79e5");e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},5078:function(e,t,n){"use strict";var r=n("5bbf");n.n(r).a},"514a":function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"e",function(){return c});var r=n("9bd2");function i(e){return Object(r.a)({url:"/interface/"+e,method:"get",loading:{type:"nprogress",interval:500}})}function o(e){return Object(r.a)({url:"/interface/paged",method:"get",params:e})}function a(e){return Object(r.a)({url:"/interface/save",method:"post",data:e,success:{type:"message",options:{message:"保存成功",type:"success"}}})}function s(e){return Object(r.a)({url:"/interface/del",method:"delete",params:{id:e},success:{type:"message",options:{message:"删除成功",type:"success"}}})}function l(e){return Object(r.a)({url:"/interface/batchdel",method:"delete",params:e,success:{type:"message",options:{message:"删除成功",type:"success"}}})}function c(e){return Object(r.a)({url:"/interface/relate",method:"post",data:e})}},"55dd":function(e,t,n){"use strict";var r=n("5ca1"),i=n("d8e8"),o=n("4bf8"),a=n("79e5"),s=[].sort,l=[1,2,3];r(r.P+r.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!n("2f21")(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},"5b64":function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return l});var r=n("9bd2");function i(){return Object(r.a)({url:"/auth/sys-menu/list",method:"get"})}function o(e){return Object(r.a)({url:"/auth/sys-menu/detail?menuId="+e,method:"get"})}function a(e){return Object(r.a)({url:"/auth/sys-menu/update",method:"post",data:e,success:{type:"message",options:{message:"保存成功",type:"success"}}})}function s(e){return Object(r.a)({url:"/auth/sys-menu/save",method:"post",data:e,success:{type:"message",options:{message:"保存成功",type:"success"}}})}function l(e){return Object(r.a)({url:"/auth/sys-menu/delete?menuIds="+e,method:"post",success:{type:"message",options:{message:"删除成功",type:"success"}}})}},"5bbf":function(e,t,n){},"9db4":function(e,t,n){"use strict";n.r(t);var r=n("75fc"),i=n("5b64"),o=n("56b3"),a=n.n(o);n("0dd0"),n("697e"),n("a7be"),n("cdf4"),n("f9d4"),n("8822"),n("d2de"),n("cbc8"),n("aedd");n("ae67");var s={name:"menuEditForm",props:{value:Boolean},data:function(){return{loading:!1,dialogVisible:!1}},watch:{value:function(e){this.dialogVisible=e},dialogVisible:function(e){this.$emit("input",e)}},methods:{filterType:function(e){for(var t=e,n=0;n<t.length;n++){var r=t[n];2===r.type?t.splice(n--,1):r.children&&0<r.children.length&&this.filterType(r.children)}return t},dialogOpen:function(){var n=this;this.jsonEditor||(this.jsonEditor=a.a.fromTextArea(this.$refs.textarea,{lineNumbers:!0,lineWrapping:!0,mode:"application/json",gutters:["CodeMirror-lint-markers","CodeMirror-foldgutter"],theme:"liquibyte",foldGutter:!0,lint:!0,viewportMargin:1/0})),i.d().then(function(e){var t=n.filterType(Object(r.a)(e));n.jsonEditor.setValue(JSON.stringify(t,null,2))})},save:function(){this.dialogVisible=!1,this.$emit("submit")},close:function(){this.dialogClose()},dialogClose:function(){this.dialogVisible=!1}}},l=(n("5078"),n("2877")),c=function(e){e.options.__source="src/views/sys/menu/batchEditForm.vue"},u=Object(l.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},opened:t.dialogOpen,closed:t.dialogClose}},[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n        菜单信息 \n        "),n("el-button",{attrs:{type:"primary",size:"mini",loading:t.loading},on:{click:t.save}},[t._v("保存")])],1),n("textarea",{ref:"textarea"}),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.save}},[t._v("保存")]),n("el-button",{on:{click:t.close}},[t._v("取消")])],1)])},[],!1,null,null,null);"function"==typeof c&&c(u);t.default=u.exports},e782:function(e,t,n){"use strict";n.r(t);n("55dd");var r=n("cebc"),i=n("514a"),o={name:"relateInterfaceForm",props:{menu:Object,value:Boolean},data:function(){return{dialogVisible:!1,searchForm:{name:"",path:"",method:""},loading:!1,tableData:[],page:{current:1,size:100,total:0},sort:{prop:"",order:""}}},watch:{value:function(e){this.dialogVisible=e},dialogVisible:function(e){this.$emit("input",e)}},methods:{dialogOpen:function(){this.getTableData()},getTableData:function(){var t=this,e=Object(r.a)({pageIndex:this.page.current,pageSize:this.page.size,sortBy:this.sort.prop,descending:"descending"===this.sort.order},this.searchForm,{functionId:this.menu.id});i.d(e).then(function(e){t.tableData=e.rows,t.page.total=e.totalCount})},handleSearchFormSubmit:function(){this.getTableData()},handleSearchFormReset:function(){this.$refs.searchForm.resetFields()},handleSortChange:function(e){this.sort.prop=e.prop,this.sort.order=e.order,this.getTableData()},handleSizeChange:function(e){this.page.size=e,this.getTableData()},handleCurrentChange:function(e){this.page.current=e,this.getTableData()},relateInterface:function(e,t){var n=this;i.e({functionId:this.menu.id,interfaceId:e,action:t}).then(function(){var e=1==t?"已添加":"已移除";n.$notify({title:"操作成功",message:e,type:"success"}),n.getTableData()})}}},a=n("2877"),s=function(e){e.options.__source="src/views/sys/menu/relateInterfaceForm.vue"},l=Object(a.a)(o,function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("el-dialog",{attrs:{visible:n.dialogVisible},on:{"update:visible":function(e){n.dialogVisible=e},open:n.dialogOpen}},[r("div",{attrs:{slot:"title"},slot:"title"},[n._v("关联\n        "),r("el-tag",[n._v(n._s(n.menu.title))]),n._v("接口")],1),r("el-form",{ref:"searchForm",staticStyle:{"margin-bottom":"-18px"},attrs:{inline:!0,model:n.searchForm,size:"mini"}},[r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"名称"},model:{value:n.searchForm.name,callback:function(e){n.$set(n.searchForm,"name",e)},expression:"searchForm.name"}})],1),r("el-form-item",{attrs:{label:"路径",prop:"path"}},[r("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"路径"},model:{value:n.searchForm.path,callback:function(e){n.$set(n.searchForm,"path",e)},expression:"searchForm.path"}})],1),r("el-form-item",{attrs:{label:"方法",prop:"method"}},[r("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"方法"},model:{value:n.searchForm.method,callback:function(e){n.$set(n.searchForm,"method",e)},expression:"searchForm.method"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:n.handleSearchFormSubmit}},[r("d2-icon",{attrs:{name:"search"}}),n._v(" 查询\n            ")],1)],1),r("el-form-item",[r("el-button",{on:{click:n.handleSearchFormReset}},[r("d2-icon",{attrs:{name:"refresh"}}),n._v(" 重置\n            ")],1)],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:n.tableData,size:"small",stripe:"","highlight-current-row":""},on:{"sort-change":n.handleSortChange}},[r("el-table-column",{attrs:{label:"名称",prop:"name",sortable:"custom","show-overflow-tooltip":!0},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n                "+n._s(e.row.name)+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"路径",prop:"path",sortable:"custom","show-overflow-tooltip":!0},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n                "+n._s(e.row.path)+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"方法",prop:"method",sortable:"custom","show-overflow-tooltip":!0},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n                "+n._s(e.row.method)+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"描述",prop:"description"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n                "+n._s(e.row.description)+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"状态",prop:"isAdd"},scopedSlots:n._u([{key:"default",fn:function(e){return[2==e.row.isAdd?r("el-tag",{attrs:{size:"mini",type:"info"}},[n._v("未添加")]):n._e(),1==e.row.isAdd?r("el-tag",{attrs:{size:"mini",type:"success"}},[n._v("已添加")]):n._e()]}}])}),r("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[2==t.row.isAdd?r("el-button",{attrs:{type:"primary",title:"添加",size:"mini",icon:"el-icon-plus",circle:""},on:{click:function(e){return n.relateInterface(t.row.id,1)}}}):n._e(),1==t.row.isAdd?r("el-button",{attrs:{type:"danger",title:"移除",size:"mini",icon:"el-icon-minus",circle:""},on:{click:function(e){return n.relateInterface(t.row.id,0)}}}):n._e()]}}])})],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-pagination",{staticStyle:{margin:"-10px"},attrs:{"current-page":n.page.current,"page-size":n.page.size,total:n.page.total,"page-sizes":[1,100,200,300,400],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange}})],1)],1)},[],!1,null,null,null);"function"==typeof s&&s(l);t.default=l.exports}}]);