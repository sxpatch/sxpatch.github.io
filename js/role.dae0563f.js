(window.webpackJsonp=window.webpackJsonp||[]).push([["role","chunk-7471d0b4","chunk-9abcf972","chunk-7dce8275"],{"0187":function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"c",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"i",function(){return d}),n.d(t,"g",function(){return f});var i=n("9bd2");function o(e){return Object(i.a)({url:"/auth/sys-role/pageList",method:"post",data:e})}function r(e){return Object(i.a)({url:"/auth/sys-role/detail?roleId="+e,method:"get"})}function a(){return Object(i.a)({url:"/auth/sys-menu/list",method:"get"})}function l(e){return Object(i.a)({url:"/role/pagedlist",method:"get",params:e,loading:{type:"nprogress",interval:500}})}function s(e){return Object(i.a)({url:"/auth/sys-role/delete?roleIds="+e,method:"post",success:{type:"message",options:{message:"删除成功",type:"success"}}})}function c(e){return Object(i.a)({url:"/role/batchdel",method:"delete",params:e,success:{type:"message",options:{message:"删除成功",type:"success"}}})}function u(e){return Object(i.a)({url:"/auth/sys-role/update",method:"post",data:e,success:{type:"message",options:{message:"保存成功",type:"success"}}})}function d(e){return Object(i.a)({url:"/auth/sys-role/save",method:"post",data:e,success:{type:"message",options:{message:"保存成功",type:"success"}}})}function f(e){return Object(i.a)({url:"/role/savepermission",method:"post",data:e,success:{type:"message",options:{message:"保存成功",type:"success"}}})}},"2f21":function(e,t,n){"use strict";var i=n("79e5");e.exports=function(e,t){return!!e&&i(function(){t?e.call(null,function(){},1):e.call(null)})}},"474e":function(e,t,n){"use strict";n.r(t);n("ac4d"),n("8a81"),n("ac6a");var g=n("cebc"),b=n("0187"),i={name:"roleEditForm",props:{role:Object,value:Boolean},data:function(){return{loading:!1,dialogVisible:!1,form:{roleName:"",remark:""},filterText:"",permissionList:[],menuIdLists:[]}},watch:{value:function(e){this.dialogVisible=e},dialogVisible:function(e){this.$emit("input",e)},filterText:function(e){this.$refs.tree.filter(e)}},methods:{dialogOpen:function(){var n=this;this.role.roleId?b.c(this.role.roleId).then(function(e){var t={};t.roleName=e.roleName,t.remark=e.remark,n.form=t,n.permissionList=e.menuList,n.menuIdLists=e.menuIdList,n.$refs.tree.setChecked(e.menuList,e.menuList.owner,!1)}):(this.form={},b.f().then(function(e){n.permissionList=e}))},saveRole:function(){var t=this,e=this.$refs.tree.getCheckedNodes(!1),n=this.$refs.tree.getHalfCheckedNodes(!1),i=[],o=!0,r=!1,a=void 0;try{for(var l,s=n[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var c=l.value;i.push(c.menuId)}}catch(e){r=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw a}}var u=!0,d=!1,f=void 0;try{for(var m,h=e[Symbol.iterator]();!(u=(m=h.next()).done);u=!0){var p=m.value;i.push(p.menuId)}}catch(e){d=!0,f=e}finally{try{u||null==h.return||h.return()}finally{if(d)throw f}}this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0,b.h(Object(g.a)({},t.form,{roleId:t.role.roleId,menuIds:i})).then(function(e){t.loading=!1,t.dialogVisible=!1,t.$emit("submit")})})},saveRoles:function(){var t=this,e=this.$refs.tree.getCheckedNodes(!1),n=this.$refs.tree.getHalfCheckedNodes(!1),i=[],o=!0,r=!1,a=void 0;try{for(var l,s=n[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var c=l.value;i.push(c.menuId)}}catch(e){r=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw a}}var u=!0,d=!1,f=void 0;try{for(var m,h=e[Symbol.iterator]();!(u=(m=h.next()).done);u=!0){var p=m.value;i.push(p.menuId)}}catch(e){d=!0,f=e}finally{try{u||null==h.return||h.return()}finally{if(d)throw f}}this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0,b.i(Object(g.a)({},t.form,{menuIds:i})).then(function(e){t.loading=!1,t.dialogVisible=!1,t.$emit("submit")})})},filterNode:function(e,t){return!e||-1!==t.title.indexOf(e)},close:function(){this.dialogClose()},dialogClose:function(){this.$refs.form.resetFields(),this.dialogVisible=!1}}},o=n("2877"),r=function(e){e.options.__source="src/views/sys/role/editForm.vue"},a=Object(o.a)(i,function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("el-dialog",{attrs:{title:"角色信息",visible:i.dialogVisible},on:{"update:visible":function(e){i.dialogVisible=e},opened:i.dialogOpen,closed:i.dialogClose}},[o("el-form",{ref:"form",attrs:{model:i.form,"label-width":"80px",size:"small"}},[o("el-form-item",{attrs:{prop:"roleName",label:"角色名称",rules:[{required:!0,message:"不能为空"}]}},[o("el-input",{model:{value:i.form.roleName,callback:function(e){i.$set(i.form,"roleName",e)},expression:"form.roleName"}})],1),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea"},model:{value:i.form.remark,callback:function(e){i.$set(i.form,"remark",e)},expression:"form.remark"}})],1),o("el-form-item",{attrs:{label:"设置权限"}},[o("el-tree",{ref:"tree",attrs:{"show-checkbox":"","check-on-click-node":"","default-expand-all":"",props:{label:"name",children:"children"},"highlight-current":"","node-key":"menuId",data:i.permissionList,"filter-node-method":i.filterNode,"expand-on-click-node":!1,"default-checked-keys":i.menuIdLists},scopedSlots:i._u([{key:"default",fn:function(e){var t=e.node,n=e.data;return o("span",{},[2==n.type?o("i",{staticClass:"fa fa-cog"}):i._e(),i._v(" "+i._s(t.label)+"\n      ")])}}])})],1),o("el-form-item",[i.role.roleId?o("el-button",{attrs:{type:"primary",loading:i.loading},on:{click:i.saveRole}},[i._v("保存")]):o("el-button",{attrs:{type:"primary",loading:i.loading},on:{click:i.saveRoles}},[i._v("保存")]),o("el-button",{on:{click:i.close}},[i._v("取消")])],1)],1)],1)},[],!1,null,null,null);"function"==typeof r&&r(a);t.default=a.exports},"55dd":function(e,t,n){"use strict";var i=n("5ca1"),o=n("d8e8"),r=n("4bf8"),a=n("79e5"),l=[].sort,s=[1,2,3];i(i.P+i.F*(a(function(){s.sort(void 0)})||!a(function(){s.sort(null)})||!n("2f21")(l)),"Array",{sort:function(e){return void 0===e?l.call(r(this)):l.call(r(this),o(e))}})},"5b64":function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"c",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return s});var i=n("9bd2");function o(){return Object(i.a)({url:"/auth/sys-menu/list",method:"get"})}function r(e){return Object(i.a)({url:"/auth/sys-menu/detail?menuId="+e,method:"get"})}function a(e){return Object(i.a)({url:"/auth/sys-menu/update",method:"post",data:e,success:{type:"message",options:{message:"保存成功",type:"success"}}})}function l(e){return Object(i.a)({url:"/auth/sys-menu/save",method:"post",data:e,success:{type:"message",options:{message:"保存成功",type:"success"}}})}function s(e){return Object(i.a)({url:"/auth/sys-menu/delete?menuIds="+e,method:"post",success:{type:"message",options:{message:"删除成功",type:"success"}}})}},cdfb:function(e,t,n){"use strict";n.r(t);n("55dd");var i=n("0187"),o=n("474e"),r=n("ebe1"),a=n("e7c5"),l={name:"RolePage",components:{editForm:o.default,rolePermission:r.default,roleUser:a.default},data:function(){return{searchForm:{},loading:!1,tableData:[],multipleSelection:[],page:{current:1,size:100,total:0},sort:{prop:"",order:""},role:{id:"",name:""},editFormVisible:!1,permissionDialogVisible:!1,roleUserDialogVisible:!1}},mounted:function(){this.getTableData()},methods:{getTableData:function(){var t=this,e={page:1,pageSize:15,sort:"create_time desc",condition:this.searchForm};i.e(e).then(function(e){t.tableData=e.list})},handleSearchFormSubmit:function(){this.getTableData()},handleSearchFormReset:function(){this.$refs.searchForm.resetFields()},handleSelectionChange:function(e){this.multipleSelection=e},handleSortChange:function(e){this.sort.prop=e.prop,this.sort.order=e.order,this.getTableData()},handleSizeChange:function(e){this.page.size=e,this.getTableData()},handleCurrentChange:function(e){this.page.current=e,this.getTableData()},delRole:function(e){var t=this;this.$confirm("确认删除？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){i.a(e).then(function(){t.getTableData()})})},batchDel:function(){var e=this;this.$confirm("确认删除？","确认信息",{distinguishCancelAndClose:!0,confirmButtonText:"删除",cancelButtonText:"取消"}).then(function(){i.b({ids:JSON.stringify(e.multipleSelection.map(function(e){return e.id}))}).then(function(){e.getTableData()})})},openEditForm:function(e){this.role=e,this.editFormVisible=!0},add:function(){this.role={},this.editFormVisible=!0},openPermissionDialog:function(e){this.role=e,this.permissionDialogVisible=!0},openRoleUserDialog:function(e){this.role=e,this.roleUserDialogVisible=!this.roleUserDialogVisible}}},s=n("2877"),c=function(e){e.options.__source="src/views/sys/role/index.vue"},u=Object(s.a)(l,function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("d2-container",[i("template",{slot:"header"},[i("el-form",{ref:"searchForm",staticStyle:{"margin-bottom":"-18px"},attrs:{inline:!0,model:n.searchForm,size:"mini"}},[i("el-form-item",{attrs:{label:"名称",prop:"roleName"}},[i("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"名称"},model:{value:n.searchForm.roleName,callback:function(e){n.$set(n.searchForm,"roleName",e)},expression:"searchForm.roleName"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:n.handleSearchFormSubmit}},[i("d2-icon",{attrs:{name:"search"}}),n._v(" 查询\n        ")],1)],1),i("el-form-item",[i("el-button",{on:{click:n.handleSearchFormReset}},[i("d2-icon",{attrs:{name:"refresh"}}),n._v(" 重置\n        ")],1)],1)],1)],1),i("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-circle-plus"},on:{click:n.add}},[n._v("\n    新增\n  ")]),0<n.multipleSelection.length?i("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:n.batchDel}},[n._v("\n    删除\n  ")]):n._e(),i("el-popover",{attrs:{placement:"top-start",title:"温馨提示",width:"200",trigger:"hover"}},[i("li",[n._v("121212")]),i("el-button",{staticStyle:{float:"right"},attrs:{slot:"reference",size:"mini",icon:"el-icon-info"},slot:"reference"},[n._v("\n      操作提示\n    ")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:n.tableData,size:"small",stripe:"","highlight-current-row":""},on:{"selection-change":n.handleSelectionChange,"sort-change":n.handleSortChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{label:"名称",prop:"name",sortable:"custom"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(e.row.roleName)+"\n      ")]}}])}),i("el-table-column",{attrs:{label:"标识",prop:"code",sortable:"custom","show-overflow-tooltip":!0},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(e.row.code)+"\n      ")]}}])}),i("el-table-column",{attrs:{label:"描述","show-overflow-tooltip":!0},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(e.row.remark)+"\n      ")]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",title:"编辑",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(e){return n.openEditForm(t.row)}}}),i("el-button",{attrs:{type:"danger",title:"删除",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(e){return n.delRole(t.row.roleId)}}})]}}])})],1),i("template",{slot:"footer"},[i("el-pagination",{staticStyle:{margin:"-10px"},attrs:{"current-page":n.page.current,"page-size":n.page.size,total:n.page.total,"page-sizes":[1,100,200,300,400],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange}})],1),i("edit-form",{attrs:{role:n.role},on:{submit:n.getTableData},model:{value:n.editFormVisible,callback:function(e){n.editFormVisible=e},expression:"editFormVisible"}}),i("role-permission",{attrs:{role:n.role},model:{value:n.permissionDialogVisible,callback:function(e){n.permissionDialogVisible=e},expression:"permissionDialogVisible"}}),i("role-user",{attrs:{role:n.role},model:{value:n.roleUserDialogVisible,callback:function(e){n.roleUserDialogVisible=e},expression:"roleUserDialogVisible"}})],2)},[],!1,null,null,null);"function"==typeof c&&c(u);t.default=u.exports},e7c5:function(e,t,n){"use strict";n.r(t);var i,o=n("cebc"),r=(n("55dd"),n("96cf"),n("3b8d")),a=n("8930"),l={name:"roleUser",props:{role:Object,value:Boolean},data:function(){return{dialogVisible:!1,searchForm:{name:"",email:""},loading:!1,tableData:[],page:{current:1,size:100,total:0},sort:{prop:"",order:""}}},watch:{value:function(e){this.dialogVisible=e},dialogVisible:function(e){this.$emit("input",e)}},methods:{dialogOpen:(i=Object(r.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.getTableData();case 1:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),getTableData:function(){var t=this,e={pageIndex:this.page.current,pageSize:this.page.size,sortBy:this.sort.prop,descending:"descending"===this.sort.order,filter:Object(o.a)({},this.searchForm,{roleId:this.role.id})};a.h(e).then(function(e){t.tableData=e.rows,t.page.total=e.totalCount})},handleSearchFormSubmit:function(){this.getTableData()},handleSearchFormReset:function(){this.$refs.searchForm.resetFields()},handleSortChange:function(e){this.sort.prop=e.prop,this.sort.order=e.order,this.getTableData()},handleSizeChange:function(e){this.page.size=e,this.getTableData()},handleCurrentChange:function(e){this.page.current=e,this.getTableData()},modifyRoleUser:function(e,t){var n=this;a.e({roleId:this.role.id,userId:e,action:t}).then(function(){var e=1==t?"已添加":"已移除";n.$notify({title:"操作成功",message:e,type:"success"}),n.getTableData()})}}},s=n("2877"),c=function(e){e.options.__source="src/views/sys/role/roleUser.vue"},u=Object(s.a)(l,function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("el-dialog",{attrs:{visible:n.dialogVisible},on:{"update:visible":function(e){n.dialogVisible=e},open:n.dialogOpen}},[i("div",{attrs:{slot:"title"},slot:"title"},[n._v("维护\n    "),i("el-tag",[n._v(n._s(n.role.name))]),n._v("用户")],1),i("el-form",{ref:"searchForm",staticStyle:{"margin-bottom":"-18px"},attrs:{inline:!0,model:n.searchForm,size:"mini"}},[i("el-form-item",{attrs:{label:"名称",prop:"name"}},[i("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"名称"},model:{value:n.searchForm.name,callback:function(e){n.$set(n.searchForm,"name",e)},expression:"searchForm.name"}})],1),i("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[i("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"邮箱"},model:{value:n.searchForm.email,callback:function(e){n.$set(n.searchForm,"email",e)},expression:"searchForm.email"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:n.handleSearchFormSubmit}},[i("d2-icon",{attrs:{name:"search"}}),n._v(" 查询\n      ")],1)],1),i("el-form-item",[i("el-button",{on:{click:n.handleSearchFormReset}},[i("d2-icon",{attrs:{name:"refresh"}}),n._v(" 重置\n      ")],1)],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:n.tableData,size:"small",stripe:"","highlight-current-row":""},on:{"sort-change":n.handleSortChange}},[i("el-table-column",{attrs:{label:"账号名称",prop:"name"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(e.row.name)+"\n      ")]}}])}),i("el-table-column",{attrs:{label:"用户名称",prop:"trueName"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(e.row.trueName)+"\n      ")]}}])}),i("el-table-column",{attrs:{label:"邮箱",prop:"email",sortable:"custom","show-overflow-tooltip":!0},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(e.row.email)+"\n      ")]}}])}),i("el-table-column",{attrs:{label:"phone",prop:"phone"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v("\n        "+n._s(e.row.phone)+"\n      ")]}}])}),i("el-table-column",{attrs:{label:"状态",prop:"isAdd"},scopedSlots:n._u([{key:"default",fn:function(e){return[2==e.row.isAdd?i("el-tag",{attrs:{size:"mini",type:"info"}},[n._v("未添加")]):n._e(),1==e.row.isAdd?i("el-tag",{attrs:{size:"mini",type:"success"}},[n._v("已添加")]):n._e()]}}])}),i("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[2==t.row.isAdd?i("el-button",{attrs:{type:"primary",title:"添加",size:"mini",icon:"el-icon-plus",circle:""},on:{click:function(e){return n.modifyRoleUser(t.row.id,1)}}}):n._e(),1==t.row.isAdd?i("el-button",{attrs:{type:"danger",title:"移除",size:"mini",icon:"el-icon-minus",circle:""},on:{click:function(e){return n.modifyRoleUser(t.row.id,0)}}}):n._e()]}}])})],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-pagination",{staticStyle:{margin:"-10px"},attrs:{"current-page":n.page.current,"page-size":n.page.size,total:n.page.total,"page-sizes":[1,100,200,300,400],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange}})],1)],1)},[],!1,null,null,null);"function"==typeof c&&c(u);t.default=u.exports},ebe1:function(e,t,n){"use strict";n.r(t);n("ac4d"),n("8a81"),n("ac6a"),n("96cf");var i,o=n("3b8d"),u=n("0187"),r=n("5b64"),a={name:"rolePermission",props:{role:Object,value:Boolean},data:function(){return{loading:!1,dialogVisible:!1,filterText:"",permissionList:[]}},watch:{value:function(e){this.dialogVisible=e},dialogVisible:function(e){this.$emit("input",e)},filterText:function(e){this.$refs.tree.filter(e)}},methods:{dialogOpen:(i=Object(o.a)(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.d();case 2:return this.permissionList=e.sent,e.next=5,u.e(this.role.id);case 5:t=e.sent,n=t.map(function(e){return e.functionId}),this.$refs.tree.setCheckedKeys(n);case 8:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),filterNode:function(e,t){return!e||-1!==t.title.indexOf(e)},saveRolePermission:function(){var t=this,e=this.$refs.tree.getCheckedNodes(!0,!1),n=[],i=!0,o=!1,r=void 0;try{for(var a,l=e[Symbol.iterator]();!(i=(a=l.next()).done);i=!0){var s=a.value;2==s.type&&n.push(s.id)}}catch(e){o=!0,r=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw r}}var c={roleId:this.role.id,permissions:n};this.loading=!0,u.g(c).then(function(e){t.loading=!1,t.dialogVisible=!1})},close:function(){this.dialogVisible=!1}}},l=n("2877"),s=function(e){e.options.__source="src/views/sys/role/rolePermission.vue"},c=Object(l.a)(a,function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("el-dialog",{attrs:{visible:i.dialogVisible},on:{"update:visible":function(e){i.dialogVisible=e},open:i.dialogOpen}},[o("div",{attrs:{slot:"title"},slot:"title"},[i._v("维护\n    "),o("el-tag",[i._v(i._s(i.role.name))]),i._v("权限")],1),o("el-input",{staticStyle:{"padding-bottom":"5px"},attrs:{size:"mini",placeholder:"输入关键字进行过滤"},model:{value:i.filterText,callback:function(e){i.filterText=e},expression:"filterText"}}),o("el-tree",{ref:"tree",attrs:{"show-checkbox":"","check-on-click-node":"","default-expand-all":"",props:{label:"name"},"highlight-current":"","node-key":"id",data:i.permissionList,"filter-node-method":i.filterNode,"expand-on-click-node":!1},scopedSlots:i._u([{key:"default",fn:function(e){var t=e.node,n=e.data;return o("span",{},[2==n.type?o("i",{staticClass:"fa fa-cog"}):i._e(),i._v(" "+i._s(t.label)+"\n    ")])}}])}),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",loading:i.loading},on:{click:i.saveRolePermission}},[i._v("保存")]),o("el-button",{on:{click:i.close}},[i._v("取消")])],1)],1)},[],!1,null,null,null);"function"==typeof s&&s(c);t.default=c.exports}}]);